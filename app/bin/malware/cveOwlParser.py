# pip install owlready2 treba dat
from owlready2 import *
import os
import json

# Change the current working directory to the directory where the script is located
os.chdir(os.path.dirname(os.path.abspath(__file__)))

# Load ontology
malwareTemplate = get_ontology("output/CVE-2000-owl.owl").load()

# Delete prefix from predicates
object_properties = [str(prop).split('.')[-1] for prop in malwareTemplate.object_properties() if not isinstance(prop, ThingClass)]
data_properties = [str(prop).split('.')[-1] for prop in malwareTemplate.data_properties()]

# Prepare data for JSON
data = {
    "Object Properties": object_properties,
    "Data Properties": data_properties
}

with open('output/cve_object_properties.json', 'w') as f:
    json.dump(data["Object Properties"], f)

    
with open('output/cve_data_properties.json', 'w') as f:
    json.dump(data["Data Properties"], f)

# Convert data to JSON and print it
# json_data = json.dumps(data)
# print(json_data)
